{"ast":null,"code":"import _objectSpread from\"/Users/abdulazim/Documents/web_stuff/real-projects/toshmi-admin/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/Users/abdulazim/Documents/web_stuff/real-projects/toshmi-admin/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"fileId\",\"alt\",\"style\"];import React,{useState,useEffect}from'react';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthImage=_ref=>{let{fileId,alt,style}=_ref,props=_objectWithoutProperties(_ref,_excluded);const[imageSrc,setImageSrc]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{if(fileId){fetchImage();}else{setLoading(false);setError('File ID mavjud emas');}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[fileId]);const fetchImage=async()=>{try{setLoading(true);setError(null);console.log('Fetching image for fileId:',fileId);// Debug log\nconst response=await api.get(\"/files/\".concat(fileId),{responseType:'blob'});if(response.data){const imageUrl=URL.createObjectURL(response.data);setImageSrc(imageUrl);console.log('Image loaded successfully:',fileId);// Debug log\n}else{setError('Javob bo\\'sh');}}catch(err){var _err$response;console.error('Image fetch error:',err);// Debug log\nsetError(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===404?'Rasm topilmadi':'Yuklanmadi');}finally{setLoading(false);}};useEffect(()=>{return()=>{if(imageSrc){URL.revokeObjectURL(imageSrc);}};},[imageSrc]);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:_objectSpread(_objectSpread({},style),{},{display:'flex',alignItems:'center',justifyContent:'center',backgroundColor:'#f3f4f6',color:'#9ca3af',fontSize:'12px'}),children:\"Yuklanmoqda...\"});}if(error||!imageSrc){return/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},style),{},{display:'flex',alignItems:'center',justifyContent:'center',backgroundColor:'#fef2f2',color:'#ef4444',fontSize:'12px',textAlign:'center',padding:'4px'}),children:[error||'Xatolik',/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{children:[\"ID: \",fileId]})]});}return/*#__PURE__*/_jsx(\"img\",_objectSpread({src:imageSrc,alt:alt,style:style},props));};export default AuthImage;","map":{"version":3,"names":["React","useState","useEffect","api","jsx","_jsx","jsxs","_jsxs","AuthImage","_ref","fileId","alt","style","props","_objectWithoutProperties","_excluded","imageSrc","setImageSrc","loading","setLoading","error","setError","fetchImage","console","log","response","get","concat","responseType","data","imageUrl","URL","createObjectURL","err","_err$response","status","revokeObjectURL","_objectSpread","display","alignItems","justifyContent","backgroundColor","color","fontSize","children","textAlign","padding","src"],"sources":["/Users/abdulazim/Documents/web_stuff/real-projects/toshmi-admin/src/components/common/AuthImage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport api from '../../services/api';\n\nconst AuthImage = ({ fileId, alt, style, ...props }) => {\n  const [imageSrc, setImageSrc] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    if (fileId) {\n      fetchImage();\n    } else {\n      setLoading(false);\n      setError('File ID mavjud emas');\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fileId]);\n\n  const fetchImage = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      console.log('Fetching image for fileId:', fileId); // Debug log\n      \n      const response = await api.get(`/files/${fileId}`, {\n        responseType: 'blob'\n      });\n      \n      if (response.data) {\n        const imageUrl = URL.createObjectURL(response.data);\n        setImageSrc(imageUrl);\n        console.log('Image loaded successfully:', fileId); // Debug log\n      } else {\n        setError('Javob bo\\'sh');\n      }\n    } catch (err) {\n      console.error('Image fetch error:', err); // Debug log\n      setError(err.response?.status === 404 ? 'Rasm topilmadi' : 'Yuklanmadi');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      if (imageSrc) {\n        URL.revokeObjectURL(imageSrc);\n      }\n    };\n  }, [imageSrc]);\n\n  if (loading) {\n    return (\n      <div style={{\n        ...style,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#f3f4f6',\n        color: '#9ca3af',\n        fontSize: '12px'\n      }}>\n        Yuklanmoqda...\n      </div>\n    );\n  }\n\n  if (error || !imageSrc) {\n    return (\n      <div style={{\n        ...style,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#fef2f2',\n        color: '#ef4444',\n        fontSize: '12px',\n        textAlign: 'center',\n        padding: '4px'\n      }}>\n        {error || 'Xatolik'}\n        <br />\n        <small>ID: {fileId}</small>\n      </div>\n    );\n  }\n\n  return (\n    <img\n      src={imageSrc}\n      alt={alt}\n      style={style}\n      {...props}\n    />\n  );\n};\n\nexport default AuthImage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}