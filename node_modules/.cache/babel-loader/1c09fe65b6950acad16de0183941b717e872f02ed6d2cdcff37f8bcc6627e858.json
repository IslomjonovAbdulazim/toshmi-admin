{"ast":null,"code":"import React from'react';import{useActivity}from'../../contexts/ActivityContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ConnectionStatus=_ref=>{let{channel,showText=true,size='sm',userList=[]}=_ref;const activity=useActivity();const status=activity.getConnectionStatus?activity.getConnectionStatus(channel):'disconnected';// Calculate online count from specific user list if provided, otherwise use general count\nlet onlineCount=0;if(userList.length>0){const activityData=activity.getData(channel);onlineCount=userList.filter(user=>{const activityInfo=activityData.find(activityItem=>activityItem.user_id===user.id);if(activityInfo&&activityInfo.last_active){const timeDiff=Date.now()-new Date(activityInfo.last_active).getTime();return timeDiff<=10000;// 10 seconds threshold\n}return false;}).length;}else{onlineCount=activity.getOnlineCount?activity.getOnlineCount(channel):0;}const getStatusConfig=()=>{switch(status){case'connected':return{color:'text-green-500',bgColor:'bg-green-500',text:\"Ulangan (\".concat(onlineCount,\" faol)\"),icon:'●'};case'connecting':case'reconnecting':return{color:'text-yellow-500',bgColor:'bg-yellow-500',text:'Ulanmoqda...',icon:'◐'};case'error':case'failed':return{color:'text-red-500',bgColor:'bg-red-500',text:'Ulanish xatosi',icon:'●'};default:return{color:'text-gray-500',bgColor:'bg-gray-500',text:'Ulanmagan',icon:'●'};}};const config=getStatusConfig();const sizeClasses={xs:'text-xs',sm:'text-sm',md:'text-base',lg:'text-lg'};const dotSizes={xs:'w-2 h-2',sm:'w-3 h-3',md:'w-4 h-4',lg:'w-5 h-5'};if(!showText){return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(dotSizes[size],\" \").concat(config.bgColor,\" rounded-full inline-block\"),title:config.text});}return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 \".concat(sizeClasses[size]),children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(dotSizes[size],\" \").concat(config.bgColor,\" rounded-full\"),title:config.text}),/*#__PURE__*/_jsx(\"span\",{className:config.color,children:config.text})]});};export default ConnectionStatus;","map":{"version":3,"names":["React","useActivity","jsx","_jsx","jsxs","_jsxs","ConnectionStatus","_ref","channel","showText","size","userList","activity","status","getConnectionStatus","onlineCount","length","activityData","getData","filter","user","activityInfo","find","activityItem","user_id","id","last_active","timeDiff","Date","now","getTime","getOnlineCount","getStatusConfig","color","bgColor","text","concat","icon","config","sizeClasses","xs","sm","md","lg","dotSizes","className","title","children"],"sources":["/Users/abdulazim/Documents/web_stuff/real-projects/toshmi-admin/src/components/common/ConnectionStatus.js"],"sourcesContent":["import React from 'react';\nimport { useActivity } from '../../contexts/ActivityContext';\n\nconst ConnectionStatus = ({ channel, showText = true, size = 'sm', userList = [] }) => {\n  const activity = useActivity();\n  \n  const status = activity.getConnectionStatus ? activity.getConnectionStatus(channel) : 'disconnected';\n  \n  // Calculate online count from specific user list if provided, otherwise use general count\n  let onlineCount = 0;\n  if (userList.length > 0) {\n    const activityData = activity.getData(channel);\n    onlineCount = userList.filter(user => {\n      const activityInfo = activityData.find(activityItem => activityItem.user_id === user.id);\n      if (activityInfo && activityInfo.last_active) {\n        const timeDiff = Date.now() - new Date(activityInfo.last_active).getTime();\n        return timeDiff <= 10000; // 10 seconds threshold\n      }\n      return false;\n    }).length;\n  } else {\n    onlineCount = activity.getOnlineCount ? activity.getOnlineCount(channel) : 0;\n  }\n  \n  const getStatusConfig = () => {\n    switch (status) {\n      case 'connected':\n        return {\n          color: 'text-green-500',\n          bgColor: 'bg-green-500',\n          text: `Ulangan (${onlineCount} faol)`,\n          icon: '●'\n        };\n      case 'connecting':\n      case 'reconnecting':\n        return {\n          color: 'text-yellow-500',\n          bgColor: 'bg-yellow-500',\n          text: 'Ulanmoqda...',\n          icon: '◐'\n        };\n      case 'error':\n      case 'failed':\n        return {\n          color: 'text-red-500',\n          bgColor: 'bg-red-500',\n          text: 'Ulanish xatosi',\n          icon: '●'\n        };\n      default:\n        return {\n          color: 'text-gray-500',\n          bgColor: 'bg-gray-500',\n          text: 'Ulanmagan',\n          icon: '●'\n        };\n    }\n  };\n\n  const config = getStatusConfig();\n  const sizeClasses = {\n    xs: 'text-xs',\n    sm: 'text-sm',\n    md: 'text-base',\n    lg: 'text-lg'\n  };\n\n  const dotSizes = {\n    xs: 'w-2 h-2',\n    sm: 'w-3 h-3',\n    md: 'w-4 h-4',\n    lg: 'w-5 h-5'\n  };\n\n  if (!showText) {\n    return (\n      <div \n        className={`${dotSizes[size]} ${config.bgColor} rounded-full inline-block`}\n        title={config.text}\n      />\n    );\n  }\n\n  return (\n    <div className={`flex items-center gap-2 ${sizeClasses[size]}`}>\n      <div \n        className={`${dotSizes[size]} ${config.bgColor} rounded-full`}\n        title={config.text}\n      />\n      <span className={config.color}>\n        {config.text}\n      </span>\n    </div>\n  );\n};\n\nexport default ConnectionStatus;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,gCAAgC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE7D,KAAM,CAAAC,gBAAgB,CAAGC,IAAA,EAA8D,IAA7D,CAAEC,OAAO,CAAEC,QAAQ,CAAG,IAAI,CAAEC,IAAI,CAAG,IAAI,CAAEC,QAAQ,CAAG,EAAG,CAAC,CAAAJ,IAAA,CAChF,KAAM,CAAAK,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAY,MAAM,CAAGD,QAAQ,CAACE,mBAAmB,CAAGF,QAAQ,CAACE,mBAAmB,CAACN,OAAO,CAAC,CAAG,cAAc,CAEpG;AACA,GAAI,CAAAO,WAAW,CAAG,CAAC,CACnB,GAAIJ,QAAQ,CAACK,MAAM,CAAG,CAAC,CAAE,CACvB,KAAM,CAAAC,YAAY,CAAGL,QAAQ,CAACM,OAAO,CAACV,OAAO,CAAC,CAC9CO,WAAW,CAAGJ,QAAQ,CAACQ,MAAM,CAACC,IAAI,EAAI,CACpC,KAAM,CAAAC,YAAY,CAAGJ,YAAY,CAACK,IAAI,CAACC,YAAY,EAAIA,YAAY,CAACC,OAAO,GAAKJ,IAAI,CAACK,EAAE,CAAC,CACxF,GAAIJ,YAAY,EAAIA,YAAY,CAACK,WAAW,CAAE,CAC5C,KAAM,CAAAC,QAAQ,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,GAAI,CAAAD,IAAI,CAACP,YAAY,CAACK,WAAW,CAAC,CAACI,OAAO,CAAC,CAAC,CAC1E,MAAO,CAAAH,QAAQ,EAAI,KAAK,CAAE;AAC5B,CACA,MAAO,MAAK,CACd,CAAC,CAAC,CAACX,MAAM,CACX,CAAC,IAAM,CACLD,WAAW,CAAGH,QAAQ,CAACmB,cAAc,CAAGnB,QAAQ,CAACmB,cAAc,CAACvB,OAAO,CAAC,CAAG,CAAC,CAC9E,CAEA,KAAM,CAAAwB,eAAe,CAAGA,CAAA,GAAM,CAC5B,OAAQnB,MAAM,EACZ,IAAK,WAAW,CACd,MAAO,CACLoB,KAAK,CAAE,gBAAgB,CACvBC,OAAO,CAAE,cAAc,CACvBC,IAAI,aAAAC,MAAA,CAAcrB,WAAW,UAAQ,CACrCsB,IAAI,CAAE,GACR,CAAC,CACH,IAAK,YAAY,CACjB,IAAK,cAAc,CACjB,MAAO,CACLJ,KAAK,CAAE,iBAAiB,CACxBC,OAAO,CAAE,eAAe,CACxBC,IAAI,CAAE,cAAc,CACpBE,IAAI,CAAE,GACR,CAAC,CACH,IAAK,OAAO,CACZ,IAAK,QAAQ,CACX,MAAO,CACLJ,KAAK,CAAE,cAAc,CACrBC,OAAO,CAAE,YAAY,CACrBC,IAAI,CAAE,gBAAgB,CACtBE,IAAI,CAAE,GACR,CAAC,CACH,QACE,MAAO,CACLJ,KAAK,CAAE,eAAe,CACtBC,OAAO,CAAE,aAAa,CACtBC,IAAI,CAAE,WAAW,CACjBE,IAAI,CAAE,GACR,CAAC,CACL,CACF,CAAC,CAED,KAAM,CAAAC,MAAM,CAAGN,eAAe,CAAC,CAAC,CAChC,KAAM,CAAAO,WAAW,CAAG,CAClBC,EAAE,CAAE,SAAS,CACbC,EAAE,CAAE,SAAS,CACbC,EAAE,CAAE,WAAW,CACfC,EAAE,CAAE,SACN,CAAC,CAED,KAAM,CAAAC,QAAQ,CAAG,CACfJ,EAAE,CAAE,SAAS,CACbC,EAAE,CAAE,SAAS,CACbC,EAAE,CAAE,SAAS,CACbC,EAAE,CAAE,SACN,CAAC,CAED,GAAI,CAAClC,QAAQ,CAAE,CACb,mBACEN,IAAA,QACE0C,SAAS,IAAAT,MAAA,CAAKQ,QAAQ,CAAClC,IAAI,CAAC,MAAA0B,MAAA,CAAIE,MAAM,CAACJ,OAAO,8BAA6B,CAC3EY,KAAK,CAAER,MAAM,CAACH,IAAK,CACpB,CAAC,CAEN,CAEA,mBACE9B,KAAA,QAAKwC,SAAS,4BAAAT,MAAA,CAA6BG,WAAW,CAAC7B,IAAI,CAAC,CAAG,CAAAqC,QAAA,eAC7D5C,IAAA,QACE0C,SAAS,IAAAT,MAAA,CAAKQ,QAAQ,CAAClC,IAAI,CAAC,MAAA0B,MAAA,CAAIE,MAAM,CAACJ,OAAO,iBAAgB,CAC9DY,KAAK,CAAER,MAAM,CAACH,IAAK,CACpB,CAAC,cACFhC,IAAA,SAAM0C,SAAS,CAAEP,MAAM,CAACL,KAAM,CAAAc,QAAA,CAC3BT,MAAM,CAACH,IAAI,CACR,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAA7B,gBAAgB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}